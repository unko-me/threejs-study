THREE.OrthographicTrackballControls=function(e,t){function o(e){u.enabled!==!1&&(window.removeEventListener("keydown",o),E=g,g===d.NONE&&(e.keyCode!==u.keys[d.ROTATE]||u.noRotate?e.keyCode!==u.keys[d.ZOOM]||u.noZoom?e.keyCode!==u.keys[d.PAN]||u.noPan||(g=d.PAN):g=d.ZOOM:g=d.ROTATE))}function n(){u.enabled!==!1&&(g=E,window.addEventListener("keydown",o,!1))}function i(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g===d.NONE&&(g=e.button),g!==d.ROTATE||u.noRotate?g!==d.ZOOM||u.noZoom?g!==d.PAN||u.noPan||(w=M=u.getMouseOnScreen(e.clientX,e.clientY)):O=v=u.getMouseOnScreen(e.clientX,e.clientY):m=f=u.getMouseProjectionOnBall(e.clientX,e.clientY),document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",c,!1))}function s(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g!==d.ROTATE||u.noRotate?g!==d.ZOOM||u.noZoom?g!==d.PAN||u.noPan||(M=u.getMouseOnScreen(e.clientX,e.clientY)):v=u.getMouseOnScreen(e.clientX,e.clientY):f=u.getMouseProjectionOnBall(e.clientX,e.clientY))}function c(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g=d.NONE,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c))}function a(e){if(u.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),O.y+=.01*t}}function r(e){if(u.enabled!==!1)switch(e.touches.length){case 1:g=d.TOUCH_ROTATE,m=f=u.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY);break;case 2:g=d.TOUCH_ZOOM;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;T=j=Math.sqrt(t*t+o*o);break;case 3:g=d.TOUCH_PAN,w=M=u.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY);break;default:g=d.NONE}}function h(e){if(u.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:f=u.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY);break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;T=Math.sqrt(t*t+o*o);break;case 3:M=u.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY);break;default:g=d.NONE}}function p(e){if(u.enabled!==!1){switch(e.touches.length){case 1:m=f=u.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY);break;case 2:j=T=0;break;case 3:w=M=u.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY)}g=d.NONE}}var u=this,d={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={width:0,height:0,offsetLeft:0,offsetTop:0},this.radius=(this.screen.width+this.screen.height)/4,this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new THREE.Vector3;var l=new THREE.Vector3,g=d.NONE,E=d.NONE,b=new THREE.Vector3,m=new THREE.Vector3,f=new THREE.Vector3,O=new THREE.Vector2,v=new THREE.Vector2,y=1,j=0,T=0,w=new THREE.Vector2,M=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom,this.center0=new THREE.Vector2((this.left0+this.right0)/2,(this.top0+this.bottom0)/2);var R={type:"change"};this.handleResize=function(){this.screen.width=window.innerWidth,this.screen.height=window.innerHeight,this.screen.offsetLeft=0,this.screen.offsetTop=0,this.radius=(this.screen.width+this.screen.height)/4},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)},this.getMouseOnScreen=function(e,t){return new THREE.Vector2((e-u.screen.offsetLeft)/u.radius*.5,(t-u.screen.offsetTop)/u.radius*.5)},this.getMouseProjectionOnBall=function(e,t){var o=new THREE.Vector3((e-.5*u.screen.width-u.screen.offsetLeft)/u.radius,(.5*u.screen.height+u.screen.offsetTop-t)/u.radius,0),n=o.length();n>1?o.normalize():o.z=Math.sqrt(1-n*n),b.copy(u.object.position).sub(u.target);var i=u.object.up.clone().setLength(o.y);return i.add(u.object.up.clone().cross(b).setLength(o.x)),i.add(b.setLength(o.z)),i},this.rotateCamera=function(){var e=Math.acos(m.dot(f)/m.length()/f.length());if(e){var t=(new THREE.Vector3).crossVectors(m,f).normalize(),o=new THREE.Quaternion;e*=u.rotateSpeed,o.setFromAxisAngle(t,-e),b.applyQuaternion(o),u.object.up.applyQuaternion(o),f.applyQuaternion(o),u.staticMoving?m.copy(f):(o.setFromAxisAngle(t,e*(u.dynamicDampingFactor-1)),m.applyQuaternion(o))}},this.zoomCamera=function(){if(g===d.TOUCH_ZOOM){var e=j/T;j=T,y*=e,u.object.left=y*u.left0+(1-y)*u.center0.x,u.object.right=y*u.right0+(1-y)*u.center0.x,u.object.top=y*u.top0+(1-y)*u.center0.y,u.object.bottom=y*u.bottom0+(1-y)*u.center0.y}else{var e=1+(v.y-O.y)*u.zoomSpeed;1!==e&&e>0&&(y*=e,u.object.left=y*u.left0+(1-y)*u.center0.x,u.object.right=y*u.right0+(1-y)*u.center0.x,u.object.top=y*u.top0+(1-y)*u.center0.y,u.object.bottom=y*u.bottom0+(1-y)*u.center0.y,u.staticMoving?O.copy(v):O.y+=(v.y-O.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var e=M.clone().sub(w);if(e.lengthSq()){e.multiplyScalar(b.length()*u.panSpeed);var t=b.clone().cross(u.object.up).setLength(e.x);t.add(u.object.up.clone().setLength(e.y)),u.object.position.add(t),u.target.add(t),u.staticMoving?w=M:w.add(e.subVectors(M,w).multiplyScalar(u.dynamicDampingFactor))}},this.update=function(){b.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||(u.zoomCamera(),u.object.updateProjectionMatrix()),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,b),u.object.lookAt(u.target),l.distanceToSquared(u.object.position)>0&&(u.dispatchEvent(R),l.copy(u.object.position))},this.reset=function(){g=d.NONE,E=d.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),b.subVectors(u.object.position,u.target),u.object.left=u.left0,u.object.right=u.right0,u.object.top=u.top0,u.object.bottom=u.bottom0,u.object.lookAt(u.target),u.dispatchEvent(R),l.copy(u.object.position)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",a,!1),this.domElement.addEventListener("DOMMouseScroll",a,!1),this.domElement.addEventListener("touchstart",r,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",o,!1),window.addEventListener("keyup",n,!1),this.handleResize()},THREE.OrthographicTrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype);