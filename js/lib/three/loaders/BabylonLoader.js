THREE.BabylonLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.BabylonLoader.prototype={constructor:THREE.ObjectLoader,load:function(e,r){var a=this,t=new THREE.XHRLoader(a.manager);t.setCrossOrigin(this.crossOrigin),t.load(e,function(e){r(a.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var r=this.parseMaterials(e.materials),a=this.parseObjects(e,r);return a},parseMaterials:function(e){for(var r={},a=0,t=e.length;t>a;a++){var i=e[a],n=new THREE.MeshPhongMaterial;n.name=i.name,n.ambient.fromArray(i.ambient),n.color.fromArray(i.diffuse),n.emissive.fromArray(i.emissive),n.specular.fromArray(i.specular),n.shininess=i.specularPower,n.opacity=i.alpha,r[i.id]=n}return r},parseObjects:function(e,r){for(var a={},t=new THREE.Scene,i=e.lights,n=0,s=i.length;s>n;n++){var o,l=i[n];switch(l.type){case 0:o=new THREE.PointLight;break;case 1:o=new THREE.DirectionalLight;break;case 2:o=new THREE.SpotLight;break;case 3:o=new THREE.HemisphereLight}o.name=l.name,o.position.set(l.position[0],l.position[1],-l.position[2]),o.color.fromArray(l.diffuse),l.intensity&&(o.intensity=l.intensity),a[l.id]=o,t.add(o)}for(var c=e.meshes,n=0,s=c.length;s>n;n++){var u,l=c[n];if(null!==l.indices){var f=new THREE.BufferGeometry;f.attributes.index={itemSize:1,array:new Uint16Array(l.indices)},f.attributes.position={itemSize:3,array:new Float32Array(l.positions)};for(var p=f.attributes.position.array,d=2,m=p.length;m>d;d+=3)p[d]=-p[d];f.attributes.normal={itemSize:3,array:new Float32Array(l.normals)};for(var h=f.attributes.normal.array,d=2,m=h.length;m>d;d+=3)h[d]=-h[d];f.attributes.uv={itemSize:2,array:new Float32Array(l.uvs)};var E=l.subMeshes;if(null!==E)for(var d=0,m=E.length;m>d;d++){var y=E[d];f.offsets.push({start:y.indexStart,index:0,count:y.indexCount})}else f.offsets.push({start:0,index:0,count:l.indices.length});var g=r[l.materialId];u=new THREE.Mesh(f,g)}else u=new THREE.Object3D;u.name=l.name,u.position.set(l.position[0],l.position[1],-l.position[2]),u.rotation.fromArray(l.rotation),u.scale.fromArray(l.scaling),void 0!==l.parentId&&""!==l.parentId?a[l.parentId].add(u):t.add(u),a[l.id]=u}return t}};