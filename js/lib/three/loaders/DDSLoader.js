THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.parse=function(r,a){function e(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}function t(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)}function o(r,a,e,t){for(var o=e*t*4,n=new Uint8Array(r,a,o),i=new Uint8Array(o),m=0,h=0,p=0;t>p;p++)for(var u=0;e>u;u++){var d=n[h];h++;var s=n[h];h++;var E=n[h];h++;var c=n[h];h++,i[m]=E,m++,i[m]=s,m++,i[m]=d,m++,i[m]=c,m++}return i}var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},i=542327876,m=131072,h=512,p=4,u=e("DXT1"),d=e("DXT3"),s=e("DXT5"),E=31,c=0,D=1,T=2,f=3,C=4,R=7,v=20,H=21,S=22,A=23,w=24,_=25,l=26,g=28,L=new Int32Array(r,0,E);if(L[c]!==i)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;if(!L[v]&p)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),n;var b,x=L[H],y=!1;switch(x){case u:b=8,n.format=THREE.RGB_S3TC_DXT1_Format;break;case d:b=16,n.format=THREE.RGBA_S3TC_DXT3_Format;break;case s:b=16,n.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(!(32==L[S]&&16711680&L[A]&&65280&L[w]&&255&L[_]&&4278190080&L[l]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",t(x)),n;y=!0,b=64,n.format=THREE.RGBAFormat}n.mipmapCount=1,L[T]&m&&a!==!1&&(n.mipmapCount=Math.max(1,L[R])),n.isCubemap=L[g]&h?!0:!1,n.width=L[C],n.height=L[f];for(var F=L[D]+4,X=n.width,M=n.height,U=n.isCubemap?6:1,B=0;U>B;B++){for(var G=0;G<n.mipmapCount;G++){if(y)var k=o(r,F,X,M),I=k.length;else var I=Math.max(4,X)/4*Math.max(4,M)/4*b,k=new Uint8Array(r,F,I);var j={data:k,width:X,height:M};n.mipmaps.push(j),F+=I,X=Math.max(.5*X,1),M=Math.max(.5*M,1)}X=n.width,M=n.height}return n};