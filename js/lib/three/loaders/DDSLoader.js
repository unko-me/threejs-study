THREE.DDSLoader=function(){},THREE.DDSLoader.prototype={constructor:THREE.DDSLoader,load:function(r,a){var e=this,t=[],o=new THREE.CompressedTexture;if(o.image=t,o.flipY=!1,o.generateMipmaps=!1,r instanceof Array){var i=0,m=new THREE.XHRLoader;m.setResponseType("arraybuffer");for(var n=function(n){m.load(r[n],function(r){var m=e.parse(r,!0);t[n]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},i+=1,6===i&&(o.format=m.format,o.needsUpdate=!0,a&&a(o))})},p=0,h=r.length;h>p;++p)n(p)}else{var m=new THREE.XHRLoader;m.setResponseType("arraybuffer"),m.load(r,function(r){var i=e.parse(r,!0);if(i.isCubemap)for(var m=i.mipmaps.length/i.mipmapCount,n=0;m>n;n++){t[n]={mipmaps:[]};for(var p=0;p<i.mipmapCount;p++)t[n].mipmaps.push(i.mipmaps[n*i.mipmapCount+p]),t[n].format=i.format,t[n].width=i.width,t[n].height=i.height}else o.image.width=i.width,o.image.height=i.height,o.mipmaps=i.mipmaps;o.format=i.format,o.needsUpdate=!0,a&&a(o)})}return o},parse:function(r,a){function e(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}function t(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)}function o(r,a,e,t){for(var o=e*t*4,i=new Uint8Array(r,a,o),m=new Uint8Array(o),n=0,p=0,h=0;t>h;h++)for(var s=0;e>s;s++){var f=i[p];p++;var u=i[p];p++;var d=i[p];p++;var c=i[p];p++,m[n]=d,n++,m[n]=u,n++,m[n]=f,n++,m[n]=c,n++}return m}var i={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},m=542327876,n=131072,p=512,h=4,s=e("DXT1"),f=e("DXT3"),u=e("DXT5"),d=31,c=0,E=1,T=2,C=3,v=4,R=7,g=20,D=21,w=22,l=23,H=24,A=25,S=26,y=28,b=new Int32Array(r,0,d);if(b[c]!==m)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),i;if(!b[g]&h)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),i;var _,L=b[D],X=!1;switch(L){case s:_=8,i.format=THREE.RGB_S3TC_DXT1_Format;break;case f:_=16,i.format=THREE.RGBA_S3TC_DXT3_Format;break;case u:_=16,i.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(!(32==b[w]&&16711680&b[l]&&65280&b[H]&&255&b[A]&&4278190080&b[S]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",t(L)),i;X=!0,_=64,i.format=THREE.RGBAFormat}i.mipmapCount=1,b[T]&n&&a!==!1&&(i.mipmapCount=Math.max(1,b[R])),i.isCubemap=b[y]&p?!0:!1,i.width=b[v],i.height=b[C];for(var U=b[E]+4,x=i.width,F=i.height,M=i.isCubemap?6:1,B=0;M>B;B++){for(var G=0;G<i.mipmapCount;G++){if(X)var k=o(r,U,x,F),I=k.length;else var I=Math.max(4,x)/4*Math.max(4,F)/4*_,k=new Uint8Array(r,U,I);var Y={data:k,width:x,height:F};i.mipmaps.push(Y),U+=I,x=Math.max(.5*x,1),F=Math.max(.5*F,1)}x=i.width,F=i.height}return i}};